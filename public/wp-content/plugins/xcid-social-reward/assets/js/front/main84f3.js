jQuery(window).load(function(a){var b=new SocialXc;jQuery(".xc-social-container.xc-social .facebook").length>0&&b.initFacebook(),jQuery(".xc-social-container.xc-social a.twitter").length>0&&b.initTwitter(),jQuery(".xc-social-container.xc-social a.vk").length>0&&b.initVk(),jQuery(".xc-social-container.xc-social a.linkedin").length>0&&b.initLinkedin()});var SocialXc=function(){var a=this;a.initFacebook=function(){var b=xc_social_reward_facebook_params.locale;jQuery.getScript("//connect.facebook.net/"+b+"/sdk.js",function(){FB.init({appId:xc_social_reward_facebook_params.app_id||null,version:"v2.3"}),FB.Event.subscribe("edge.create",function(b){b&&a.post("facebook","like")}),FB.Event.subscribe("edge.remove",function(b){b&&a.post("facebook","unlike")}),FB.XFBML.parse()}),jQuery(".xc-social-container a.facebook.share").click(a.shareOnFacebook)},a.initVk=function(){jQuery.getScript("//vk.com/js/api/openapi.js?117",function(){VK.init({apiId:xc_social_reward_vk_params.app_id||null}),jQuery(".xc-social-container a.vk.like").length>0&&VK.Widgets.Like("xc_vk_like",{type:"button",height:20},xc_social_reward_vk_params.page_id||null),VK.Observer.subscribe("widgets.like.liked",function(){a.post("vk","like")}),VK.Observer.subscribe("widgets.like.unliked",function(){a.post("vk","unlike")})})},a.shareOnFacebook=function(){FB.ui({method:"feed",link:xc_social_reward_facebook_params.share_url||null,caption:xc_social_reward_facebook_params.share_title||null,description:xc_social_reward_facebook_params.share_message||null,picture:xc_social_reward_facebook_params.share_image||null},function(b){!b||b&&0==b.length||a.post("facebook","share")})},a.initTwitter=function(){jQuery(".xc-twitter-share-button").unbind().bind("click",function(){jQuery.when(a.loginTwitter()).then(function(b){a.showTweetContainer(b.oauth_token,b.oauth_verifier)})}),jQuery(".xc-twitter-follow-button").unbind().bind("click",function(){jQuery.when(a.loginTwitter()).then(function(a){var b={action:"xc_make_twitter_action",oauth_token:a.oauth_token||null,oauth_verifier:a.oauth_verifier||null,product_id:xc_social_reward_product_id.post_id||null,type:"follow"};jQuery.post(woocommerce_params.ajax_url,b,function(a){window.location.reload()})})})},a.loginTwitter=function(){var a=jQuery.Deferred(),b=window.open(xc_social_reward_twitter_params.url,"","toolbar=0,scrollbars=1,location=0,statusbar=0,menubar=0,resizable=1,width=800,height=450");return window.twitterCallback=function(c,d){b.close(),a.resolve({oauth_token:c||null,oauth_verifier:d||null})},a.promise()},a.showTweetContainer=function(a,b){jQuery(".xc-tweet-container").fadeIn(),jQuery(".xc-tweet-container button.valid").unbind().bind("click",function(){var c={action:"xc_make_twitter_action",oauth_token:a||null,oauth_verifier:b||null,product_id:xc_social_reward_product_id.post_id||null,type:"tweet",tweet:jQuery(".xc-tweet-container textarea").val()};jQuery.post(woocommerce_params.ajax_url,c,function(a){window.location.reload()})}),jQuery(".xc-tweet-container button.cancel").unbind().bind("click",function(){jQuery(".xc-tweet-container").fadeOut()})},a.initLinkedin=function(){jQuery(".xc-linkedin-share-button").unbind().bind("click",function(){jQuery.when(a.loginLinkedin()).then(function(b){a.showShareLinkedinContainer(b.code,b.state)})})},a.loginLinkedin=function(){var a=jQuery.Deferred(),b=window.open(xc_social_reward_linkedin_params.url,"","toolbar=0,scrollbars=1,location=0,statusbar=0,menubar=0,resizable=1,width=800,height=450");return window.linkedinCallback=function(c,d){b.close(),a.resolve({code:c||null,state:d||null})},a.promise()},a.showShareLinkedinContainer=function(a,b){jQuery(".xc-linkedin-container").fadeIn(),jQuery(".xc-linkedin-container button.valid").unbind().bind("click",function(){var c={action:"xc_make_linkedin_action",code:a||null,state:b||null,product_id:xc_social_reward_product_id.post_id||null,message:jQuery(".xc-linkedin-container textarea").val()};jQuery.post(woocommerce_params.ajax_url,c,function(a){window.location.reload()})}),jQuery(".xc-linkedin-container button.cancel").unbind().bind("click",function(){jQuery(".xc-linkedin-container").fadeOut()})},a.post=function(a,b){var c={action:"xc_handle_social_response",product_id:xc_social_reward_product_id.post_id||null,network:a,type:b};jQuery.post(woocommerce_params.ajax_url,c,function(a){"yes"===a.redirect?window.location=a.cart_page:window.location.reload()})}};